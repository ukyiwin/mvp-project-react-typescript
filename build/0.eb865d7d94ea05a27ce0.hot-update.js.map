{"version":3,"file":"0.eb865d7d94ea05a27ce0.hot-update.js","sources":["webpack:///./src/server.tsx"],"sourcesContent":["import * as express from 'express';\nimport * as React from 'react';\nimport { renderToString } from 'react-dom/server';\nimport { StaticRouter } from 'react-router-dom';\n\nimport { getBundles } from 'react-loadable/webpack';\nimport { Capture } from 'react-loadable';\nimport stats from '../build/react-loadable.json';\nimport App from './Containers/App';\nimport 'isomorphic-unfetch';\nimport ApolloClient from 'apollo-client';\nimport { ApolloProvider, renderToStringWithData } from 'react-apollo';\nimport { InMemoryCache } from 'apollo-cache-inmemory';\nimport { ApolloLink } from 'apollo-link';\nimport { HttpLink } from 'apollo-link-http';\nimport fetch from 'node-fetch';\n// import { createPersistedQueryLink } from 'apollo-link-persisted-queries';\nimport {\n  errorLink,\n  httpLinkAuth,\n  requestLink,\n  retryLink,\n  stateLink\n} from './link';\n\nconst links = [\n  errorLink,\n  retryLink,\n  stateLink,\n  httpLinkAuth\n];\n\nlet assets: any;\n\nString.prototype.truncString = function(this: string, add: string, max: number) {\n  add = add || '...';\n  return (this.length > max ? this.substring(0, max) + add : this);\n};\n\nString.prototype.lengthInMinutes = function(this: string) {\n  \n    const min = this.split(' ').length / 250;\n    if (min <= 0 || min === 0) {\n      return 'less than a minute read';\n    } else if (min <= 0.9 || min === 0.9) {\n      return 'less than a minute read';\n    } else {\n      return `${min} min read`;\n    }\n};\n\nconst syncLoadAssets = () => {\n    assets = require(process.env.RAZZLE_ASSETS_MANIFEST!);\n};\nsyncLoadAssets();\n\nconst server = express();\n\nserver\n  .disable('x-powered-by')\n  .use(express.static(process.env.RAZZLE_PUBLIC_DIR!))\n  .get('/*', (req: express.Request, res: express.Response) => {\n    \n    if (process.env.NODE_ENV === 'production') {\n      // links.unshift(createPersistedQueryLink());\n    }\n\n    const client = new ApolloClient({\n      ssrMode: true,\n      link: ApolloLink.from(links),\n      cache: new InMemoryCache(),\n    });\n    \n    const context = {} as any;\n    const modules = [] as any;\n    const markup = renderToString(\n      <Capture report={(moduleName) => modules.push(moduleName)}>\n      <ApolloProvider client={client}>\n          <StaticRouter context={context} location={req.url}>\n            <App />\n          </StaticRouter>\n      </ApolloProvider>\n      </Capture>,\n    );\n\n    if (context.url) {\n      res.redirect(context.url);\n    } else {\n      const bundles = getBundles(stats, modules);\n      const chunks = bundles.filter((bundle) => bundle.file.endsWith('.js'));\n      res.send(\n        `<!doctype html>\n        <html lang=\"\">\n          <head>\n              <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n              <meta charSet='utf-8' />\n              <title>Unizonn</title>\n              <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=yes\">\n              <meta name=\"mobile-web-app-capable\" content=\"yes\">\n              <!--\n                manifest.json provides metadata used when your web app is added to the\n                homescreen on Android. See https://developers.google.com/web/fundamentals/engage-and-retain/web-app-manifest/\n              -->\n              <link rel=\"apple-touch-icon\" sizes=\"180x180\" href=\"/apple-touch-icon.png\">\n              <link rel=\"icon\" type=\"image/png\" sizes=\"32x32\" href=\"/favicon-32x32.png\">\n              <link rel=\"icon\" type=\"image/png\" sizes=\"16x16\" href=\"/favicon-16x16.png\">\n              <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n              <link rel=\"manifest\" href=\"/site.webmanifest\">\n              <link rel=\"mask-icon\" href=\"/safari-pinned-tab.svg\" color=\"#5bbad5\">\n              <meta name=\"msapplication-TileColor\" content=\"#da532c\">\n              <meta name=\"theme-color\" content=\"teal\">\n\n              <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>\n              <link href='./owl.carousel.min.css' rel='stylesheet'>\n              <link href=\"https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700\" rel=\"stylesheet\">\n              <link href=\"https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css\" rel=\"stylesheet\">\n              <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\" rel=\"stylesheet\" />\n              <link src=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.svg\"></script>\n\n              ${\n                assets.client.css\n                  ? `<link rel=\"stylesheet\" href=\"${assets.client.css}\">`\n                  : ''\n              }\n              ${\n                process.env.NODE_ENV === 'production'\n                  ? `<script src=\"${assets.client.js}\" defer></script>`\n                  : `<script src=\"${assets.client.js}\" defer crossorigin></script>`\n              }\n              \n              <script src=\"https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-beta.40/js/uikit.min.js\"></script>\n              <script src=\"https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-beta.40/js/uikit-icons.min.js\"></script>\n          </head>\n          <body>\n              <div id=\"root\">${markup}</div>\n              <script src=\"https://cdnjs.cloudflare.com/ajax/libs/animejs/2.2.0/anime.min.js\"></script>\n              <script src=\"js/lib/jquery.js\"></script>\n              <script src=\"js/lib/bootstrap.min.js\"></script>\n              <script src=\"js/lib/owl.carousel.min.js\"></script>\n              <script src=\"/js/lib/css3-animate-it.js\"></script>\n              <script src=\"./crack.js\"></script>\n              <script src=\"./timeago-in-words.js\"></script>\n              <script>\n                function anima() {\n                  [].slice.call(document.querySelectorAll('.grid--effect-vega > .grid__item')).forEach(function(stackEl) {\n                    new VegaFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-castor > .grid__item')).forEach(function(stackEl) {\n                    new CastorFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-hamal > .grid__item')).forEach(function(stackEl) {\n                    new HamalFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-polaris > .grid__item')).forEach(function(stackEl) {\n                    new PolarisFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-alphard > .grid__item')).forEach(function(stackEl) {\n                    new AlphardFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-altair > .grid__item')).forEach(function(stackEl) {\n                    new AltairFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-rigel > .grid__item')).forEach(function(stackEl) {\n                    new RigelFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-canopus > .grid__item')).forEach(function(stackEl) {\n                    new CanopusFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-pollux > .grid__item')).forEach(function(stackEl) {\n                    new PolluxFx(stackEl);\n                  });\n                  [].slice.call(document.querySelectorAll('.grid--effect-deneb > .grid__item')).forEach(function(stackEl) {\n                    new DenebFx(stackEl);\n                  });\n                };\n              </script>\n          </body>\n        </html>`\n      );\n    }\n  });\n\nexport default server;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader??ref--5!./src/server.tsx"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAMA;AACA;AACA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AAGA;AACA;AACA;AACA;;;;;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AAEA;AACA;AAEA;;;;;A","sourceRoot":""}